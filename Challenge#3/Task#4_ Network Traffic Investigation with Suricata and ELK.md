## Objective
Set up a network monitoring system to detect abnormal traffic patterns, including data exfiltration and command-and-control (C2) communication, by leveraging Suricata with Emerging Threats (ET) rules and analyzing logs using Splunk. Students will simulate a network-based attack and respond to alerts generated by the ET rules.
- `Detailed level`: Low
- `Difficulty level`: Medium

## Install Suricata
```

sudo add-apt-repository ppa:oisf/suricata-stable
sudo apt-get update
sudo apt-get install suricata -y

```

## Download Emerging Threats ruleset
```

cd /tmp/ && curl -LO https://rules.emergingthreats.net/open/suricata-6.0.8/emerging.rules.tar.gz
sudo tar -xvzf emerging.rules.tar.gz && sudo mkdir /etc/suricata/rules && sudo mv rules/*.rules /etc/suricata/rules/
sudo chmod 640 /etc/suricata/rules/*.rules

```

## Modify the Suricata setting
```
HOME_NET: "<UBUNTU_IP>"
EXTERNAL_NET: "any"

default-rule-path: /etc/suricata/rules
rule-files:
- "*.rules"

# Global stats configuration
stats:
enabled: yes

# Linux high speed capture support
af-packet:
  - interface: enp0s3


```
